ğŸ” PROMPT PARA BACKEND - ACTUALIZACIÃ“N DE RACHA EN ASISTENCIA

ğŸ“‹ PROBLEMA IDENTIFICADO:
La racha no se actualiza en la vista de lista de asistencia despuÃ©s de marcar asistencia.

ğŸ” EVIDENCIA:
- âœ… Asistencia se actualiza correctamente (200 OK)
- âœ… Botones de asistencia funcionan
- âŒ Racha permanece en 0 dÃ­as en la vista de lista

ğŸ“Š FLUJO ACTUAL:
1. Coach marca asistencia como "Presente"
2. Backend actualiza asistencia (200 OK)
3. Frontend recarga lista de asistencia
4. Racha sigue mostrando 0 dÃ­as

ğŸ”§ VERIFICACIONES REQUERIDAS EN BACKEND:

1. **Verificar endpoint de asistencia**:
   ```
   GET /identity/v1/asistencia/{gymId}/{fecha}
   ```
   - Â¿Incluye la racha actualizada en la respuesta?
   - Â¿La racha se calcula correctamente despuÃ©s de actualizar asistencia?

2. **Verificar endpoint de racha individual**:
   ```
   GET /identity/v1/usuarios/{userId}/racha
   ```
   - Â¿Se actualiza correctamente despuÃ©s de marcar asistencia?
   - Â¿Devuelve la racha actual correcta?

3. **Verificar cÃ¡lculo de racha**:
   - Â¿Se incrementa la racha cuando se marca "Presente"?
   - Â¿Se resetea a 0 cuando se marca "FaltÃ³"?
   - Â¿Se congela cuando se marca "Permiso"?

ğŸ” DIAGNÃ“STICO ESPECÃFICO:

**Paso 1**: Verificar respuesta del endpoint de asistencia:
```bash
curl -H "Authorization: Bearer [TOKEN]" \
  https://api.capbox.site/identity/v1/asistencia/562a7a0c-7f58-4183-888f-ad08664e81ea/2025-07-30
```

**Paso 2**: Verificar racha individual:
```bash
curl -H "Authorization: Bearer [TOKEN]" \
  https://api.capbox.site/identity/v1/usuarios/dd1ace33-8d27-4063-8c65-37b3dcff4feb/racha
```

**Paso 3**: Verificar logs del backend:
- Â¿Aparecen logs de actualizaciÃ³n de racha?
- Â¿Se ejecuta el cÃ¡lculo de racha despuÃ©s de actualizar asistencia?

ğŸš¨ POSIBLES CAUSAS:

1. **Endpoint de asistencia no incluye racha**: La respuesta no tiene el campo `racha_actual`
2. **Racha no se calcula**: El backend no recalcula la racha despuÃ©s de actualizar asistencia
3. **CachÃ© de datos**: Los datos estÃ¡n cacheados y no se actualizan
4. **Error en cÃ¡lculo**: El algoritmo de cÃ¡lculo de racha tiene un error

ğŸ“ ACCIÃ“N REQUERIDA:

1. **Verificar que el endpoint de asistencia incluya racha** en la respuesta
2. **Confirmar que la racha se recalcula** despuÃ©s de actualizar asistencia
3. **Revisar logs del backend** durante la actualizaciÃ³n de asistencia
4. **Probar el endpoint de racha individual** despuÃ©s de marcar asistencia

âš ï¸ URGENCIA: La funcionalidad de asistencia estÃ¡ operativa, pero la racha no se refleja en la UI.

ğŸ“Š DATOS PARA DIAGNÃ“STICO:
- Gimnasio: 562a7a0c-7f58-4183-888f-ad08664e81ea
- Alumno: dd1ace33-8d27-4063-8c65-37b3dcff4feb
- Fecha: 2025-07-30
- Status: presente

ğŸ¯ RESULTADO ESPERADO:
DespuÃ©s de marcar asistencia como "Presente", la racha debe incrementarse en la vista de lista de asistencia. 