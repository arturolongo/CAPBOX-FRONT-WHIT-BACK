===============================================================================
                    CÃ“MO MANEJA EL FRONTEND LA CLAVE DEL GIMNASIO
===============================================================================

ğŸ“‹ CONFIGURACIÃ“N DEL ENDPOINT:
--------------------------------
En ApiConfig (capbox/lib/core/api/api_config.dart):

static const String userGymKey = '/identity/v1/usuarios/gimnasio/clave';
static const String adminGymKey = '/identity/v1/usuarios/gimnasio/clave';

ğŸ“¡ MÃ‰TODO DE OBTENCIÃ“N:
------------------------
En aws_api_service.dart (lÃ­neas 153-185):

Future<Response> getMyGymKey() async {
  try {
    print('ğŸ”‘ API: Obteniendo clave del gimnasio del entrenador');
    print('ğŸŒ API: Endpoint: GET ${ApiConfig.userGymKey}');

    final response = await _dio.get(
      ApiConfig.userGymKey, // âœ… CORRECTO: SegÃºn backend
    );

    print('âœ… API: Clave del gimnasio obtenida');
    print('ğŸ“Š API: Respuesta: ${response.data}');
    return response;
  } catch (e) {
    print('âŒ API: Error obteniendo clave del gimnasio - $e');
    rethrow;
  }
}

ğŸ” AUTENTICACIÃ“N AUTOMÃTICA:
-----------------------------
En auth_interceptor.dart (lÃ­neas 18-35):

@override
Future<void> onRequest(RequestOptions options, RequestInterceptorHandler handler) async {
  // Leer el token del almacenamiento seguro
  final accessToken = await _secureStorage.read(key: 'access_token');

  if (accessToken != null) {
    options.headers['Authorization'] = 'Bearer $accessToken';
    print('ğŸ”‘ AUTH INTERCEPTOR: Token agregado a la peticiÃ³n');
    print('ğŸ” AUTH INTERCEPTOR: Token: ${accessToken.substring(0, 50)}...');
  }
}

ğŸ“‹ HEADERS ENVIADOS:
--------------------
Headers que se envÃ­an automÃ¡ticamente:
{
  'Authorization': 'Bearer <token_jwt>',
  'Content-Type': 'application/json',
  'Accept': 'application/json'
}

ğŸŒ URL COMPLETA:
----------------
GET https://api.capbox.site/identity/v1/usuarios/gimnasio/clave

ğŸ“Š RESPUESTA ESPERADA:
-----------------------
{
  "claveGym": "GYM-123456"
}

âŒ POSIBLES ERRORES:
--------------------
- 404: Usuario no tiene gimnasio asociado
- 401: Token invÃ¡lido o expirado  
- 403: Usuario sin permisos (ATLETA intentando acceder)

âœ… ESTADO ACTUAL:
------------------
SegÃºn la confirmaciÃ³n del backend (28/07/2025):

1. âœ… **Endpoint existe y funciona**
2. âœ… **URL correcta implementada**
3. âœ… **Permisos verificados**
4. âœ… **Token JWT vÃ¡lido**
5. âœ… **Credenciales OAuth2 correctas**

ğŸ”§ SOLUCIÃ“N IMPLEMENTADA POR BACKEND:
--------------------------------------
- **Para ADMIN:** Si no tiene gimnasio, se crea automÃ¡ticamente
- **Para ENTRENADOR:** Debe ser invitado por un administrador
- **Resultado:** Los ADMIN ya no reciben 404, se les crea gimnasio automÃ¡ticamente

ğŸ“‹ PRUEBAS PARA EL BACKEND:
----------------------------
Probar el endpoint directamente:

curl -X GET "https://api.capbox.site/identity/v1/usuarios/gimnasio/clave" \
  -H "Authorization: Bearer <token_vÃ¡lido>" \
  -H "Content-Type: application/json"

ğŸ” VERIFICACIONES NECESARIAS:
-----------------------------
1. âœ… El endpoint existe realmente en el backend
2. âœ… La ruta estÃ¡ correctamente configurada
3. âœ… El middleware de autenticaciÃ³n estÃ¡ funcionando
4. âœ… El usuario tiene los permisos necesarios

ğŸ“ LOGS DEL FRONTEND:
---------------------
Cuando funciona correctamente:
ğŸ”‘ API: Obteniendo clave del gimnasio del entrenador
ğŸŒ API: Endpoint: GET /identity/v1/usuarios/gimnasio/clave
âœ… API: Clave del gimnasio obtenida
ğŸ“Š API: Respuesta: {claveGym: GYM-123456}

Cuando falla (403/404):
âŒ API: Error obteniendo clave del gimnasio - DioException [bad response]: 403/404

ğŸ”‘ CREDENCIALES OAUTH2 (ORIGINALES - FUNCIONANDO):
----------------------------------------------------
// En ApiConfig
static String get oauthClientId =>
    dotenv.env['OAUTH_CLIENT_ID'] ?? 'capbox_mobile_app_prod';
static String get oauthClientSecret =>
    dotenv.env['OAUTH_CLIENT_SECRET'] ??
    'UN_SECRETO_DE_PRODUCCION_MUY_LARGO_Y_SEGURO';

===============================================================================
                    FIN DEL DOCUMENTO
=============================================================================== 